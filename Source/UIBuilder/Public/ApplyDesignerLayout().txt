void FUIBuilderTabManager::ApplyDesignerLayout(FBlueprintEditor* InBlueprintEditor, UUIBuilderBlueprintExtension* InBlueprintExtension)
{
    TSharedPtr<FTabManager> TabManager = InBlueprintEditor->GetTabManager();
    if (!TabManager.IsValid()) return;

    // ðŸªŸ Get parent window
    TSharedPtr<SWindow> ParentWindow = FSlateApplication::Get().FindWidgetWindow(
        InBlueprintEditor->GetToolkitHost()->GetParentWidget());

    // ðŸ“ Always generate a fresh layout (to trigger re-application)
    int32 Version = ++InBlueprintExtension->DesignerLayoutRestoreCount;
    FName LayoutName = FName(*FString::Printf(TEXT("UIBuilder_DesignerLayout_v%d"), Version));

    TSharedPtr<FTabManager::FLayout> Layout = FTabManager::NewLayout(LayoutName)
        ->AddArea(
            FTabManager::NewPrimaryArea()
            ->SetOrientation(Orient_Horizontal)

            ->Split(
                FTabManager::NewSplitter()
                ->SetOrientation(Orient_Vertical)
                ->Split(
                    FTabManager::NewStack()
                    ->AddTab("UIBuilderPreview", ETabState::OpenedTab)
                    ->SetHideTabWell(false)
                    ->SetSizeCoefficient(0.5f)
                )
                ->Split(
                    FTabManager::NewStack()
                    ->AddTab("UIBuilderVariables", ETabState::OpenedTab)
                    ->SetHideTabWell(false)
                    ->SetSizeCoefficient(0.5f)
                )
                ->SetSizeCoefficient(0.2f)
            )

            ->Split(
                FTabManager::NewStack()
                ->AddTab("UIBuilderGraph", ETabState::OpenedTab)
                ->SetHideTabWell(false)
                ->SetSizeCoefficient(0.6f)
            )

            ->Split(
                FTabManager::NewStack()
                ->AddTab("UIBuilderSelection", ETabState::OpenedTab)
                ->SetHideTabWell(false)
                ->SetSizeCoefficient(0.2f)
            )
        );

    // ðŸ’¾ Save layout string for debug (optional)
    InBlueprintExtension->CapturedDesignerLayoutString = Layout->ToString();

    // ðŸ•’ Delay restore by one tick
    TFunction<void()> RestoreCallback = [TabManager, Layout, ParentWindow]()
        {
            UE_LOG(LogTemp, Warning, TEXT("ðŸª„ Restoring Designer layout now"));
            TabManager->RestoreFrom(Layout.ToSharedRef(), ParentWindow);
        };

    FTSTicker::GetCoreTicker().AddTicker(
        FTickerDelegate::CreateLambda([RestoreCallback](float)
            {
                RestoreCallback();
                return false; // one-shot
            }),
        0.0f
    );
}